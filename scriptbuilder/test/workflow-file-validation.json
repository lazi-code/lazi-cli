{
  "metadata": {
    "name": "File Validation Workflow",
    "description": "Checks if a file exists and handles both success and failure cases",
    "author": "Test Suite",
    "createdAt": "2025-01-04T00:00:00.000Z",
    "scriptType": "powershell",
    "version": "1.0"
  },
  "workflow": {
    "nodes": [
      {
        "id": "node-1",
        "type": "scriptNode",
        "position": {
          "x": 100,
          "y": 200
        },
        "data": {
          "script": {
            "id": "custom-test-get-user-input",
            "name": "Get User Input",
            "category": "Input"
          },
          "config": {
            "prompt": "Enter file path to check:",
            "variableName": "targetFile",
            "secure": false
          }
        }
      },
      {
        "id": "node-2",
        "type": "scriptNode",
        "position": {
          "x": 400,
          "y": 200
        },
        "data": {
          "script": {
            "id": "custom-test-if-else",
            "name": "If-Else Conditional",
            "category": "Control Flow"
          },
          "config": {
            "leftOperand": "Test-Path $targetFile",
            "operator": "eq",
            "rightOperand": "$true"
          }
        }
      },
      {
        "id": "node-3",
        "type": "scriptNode",
        "position": {
          "x": 700,
          "y": 100
        },
        "data": {
          "script": {
            "id": "custom-test-print-output",
            "name": "Print Output",
            "category": "Output"
          },
          "config": {
            "message": "\"File exists: $targetFile\"",
            "outputType": "info"
          }
        }
      },
      {
        "id": "node-4",
        "type": "scriptNode",
        "position": {
          "x": 700,
          "y": 300
        },
        "data": {
          "script": {
            "id": "custom-test-print-output",
            "name": "Print Output",
            "category": "Output"
          },
          "config": {
            "message": "\"File not found: $targetFile\"",
            "outputType": "error"
          }
        }
      }
    ],
    "edges": [
      {
        "id": "edge-1",
        "source": "node-1",
        "target": "node-2",
        "type": "smoothstep"
      },
      {
        "id": "edge-2",
        "source": "node-2",
        "sourceHandle": "true-path",
        "target": "node-3",
        "type": "smoothstep"
      },
      {
        "id": "edge-3",
        "source": "node-2",
        "sourceHandle": "false-path",
        "target": "node-4",
        "type": "smoothstep"
      }
    ]
  },
  "requiredCustomNodes": [
    {
      "id": "custom-test-get-user-input",
      "name": "Get User Input",
      "category": "Input",
      "description": "Prompt user for input and store in a variable",
      "fields": [
        {
          "key": "prompt",
          "label": "Prompt Text",
          "type": "text",
          "placeholder": "Enter your name:",
          "helperText": "Message to display to the user",
          "defaultValue": "Enter input:"
        },
        {
          "key": "variableName",
          "label": "Variable Name",
          "type": "text",
          "placeholder": "userInput",
          "helperText": "Name of variable to store input",
          "defaultValue": "input"
        },
        {
          "key": "secure",
          "label": "Secure Input (hide typing)",
          "type": "boolean",
          "helperText": "Hide input as user types (for passwords)",
          "defaultValue": false
        }
      ],
      "generators": {
        "powershell": "(config) => config.secure ? `$${config.variableName} = Read-Host -Prompt \"${config.prompt}\" -AsSecureString` : `$${config.variableName} = Read-Host -Prompt \"${config.prompt}\"`",
        "bash": "(config) => config.secure ? `read -sp \"${config.prompt} \" ${config.variableName}` : `read -p \"${config.prompt} \" ${config.variableName}`"
      },
      "metadata": {
        "tags": ["input", "prompt", "user"],
        "createdAt": "2025-01-04T00:00:00.000Z",
        "updatedAt": "2025-01-04T00:00:00.000Z"
      }
    },
    {
      "id": "custom-test-if-else",
      "name": "If-Else Conditional",
      "category": "Control Flow",
      "description": "Branch execution based on a condition with separate true/false paths",
      "outputHandles": [
        {
          "id": "true-path",
          "label": "True",
          "position": "left",
          "color": "#16a34a"
        },
        {
          "id": "false-path",
          "label": "False",
          "position": "right",
          "color": "#dc2626"
        }
      ],
      "fields": [
        {
          "key": "leftOperand",
          "label": "Left Operand",
          "type": "text",
          "placeholder": "$variable",
          "helperText": "Variable or value to compare",
          "defaultValue": ""
        },
        {
          "key": "operator",
          "label": "Operator",
          "type": "select",
          "options": [
            { "label": "Equals (=)", "value": "eq" },
            { "label": "Not Equals (≠)", "value": "ne" },
            { "label": "Greater Than (>)", "value": "gt" },
            { "label": "Greater or Equal (≥)", "value": "ge" },
            { "label": "Less Than (<)", "value": "lt" },
            { "label": "Less or Equal (≤)", "value": "le" },
            { "label": "Contains", "value": "contains" }
          ],
          "defaultValue": "eq"
        },
        {
          "key": "rightOperand",
          "label": "Right Operand",
          "type": "text",
          "placeholder": "value",
          "helperText": "Value to compare against",
          "defaultValue": ""
        }
      ],
      "generators": {
        "powershell": "(config, branches) => { const ops = { eq: '-eq', ne: '-ne', gt: '-gt', ge: '-ge', lt: '-lt', le: '-le', contains: '-contains' }; const operator = ops[config.operator] || '-eq'; const condition = `(${config.leftOperand}) ${operator} ${config.rightOperand}`; let code = `if (${condition}) {\\n`; if (branches?.['true-path']) { code += `    ${branches['true-path'].replace(/\\n/g, '\\n    ')}\\n`; } code += `}`; if (branches?.['false-path']) { code += ` else {\\n`; code += `    ${branches['false-path'].replace(/\\n/g, '\\n    ')}\\n`; code += `}`; } return code; }",
        "bash": "(config, branches) => { const ops = { eq: '-eq', ne: '-ne', gt: '-gt', ge: '-ge', lt: '-lt', le: '-le' }; const operator = ops[config.operator] || '-eq'; let condition; if (config.operator === 'contains') { condition = `[[ ${config.leftOperand} =~ ${config.rightOperand} ]]`; } else { condition = `[ ${config.leftOperand} ${operator} ${config.rightOperand} ]`; } let code = `if ${condition}; then\\n`; if (branches?.['true-path']) { code += `    ${branches['true-path'].replace(/\\n/g, '\\n    ')}\\n`; } if (branches?.['false-path']) { code += `else\\n`; code += `    ${branches['false-path'].replace(/\\n/g, '\\n    ')}\\n`; } code += `fi`; return code; }"
      },
      "metadata": {
        "tags": ["control-flow", "conditional", "branch"],
        "createdAt": "2025-01-04T00:00:00.000Z",
        "updatedAt": "2025-01-04T00:00:00.000Z"
      }
    },
    {
      "id": "custom-test-print-output",
      "name": "Print Output",
      "category": "Output",
      "description": "Display text or variable to console",
      "fields": [
        {
          "key": "message",
          "label": "Message",
          "type": "textarea",
          "placeholder": "Hello, World!",
          "helperText": "Text or variable to display",
          "defaultValue": ""
        },
        {
          "key": "outputType",
          "label": "Output Type",
          "type": "select",
          "options": [
            { "label": "Information", "value": "info" },
            { "label": "Warning", "value": "warning" },
            { "label": "Error", "value": "error" }
          ],
          "defaultValue": "info"
        }
      ],
      "generators": {
        "powershell": "(config) => { if (config.outputType === 'warning') return `Write-Warning ${config.message}`; if (config.outputType === 'error') return `Write-Error ${config.message}`; return `Write-Host ${config.message}`; }",
        "bash": "(config) => { if (config.outputType === 'error') return `echo ${config.message} >&2`; return `echo ${config.message}`; }"
      },
      "metadata": {
        "tags": ["output", "print", "console"],
        "createdAt": "2025-01-04T00:00:00.000Z",
        "updatedAt": "2025-01-04T00:00:00.000Z"
      }
    }
  ]
}
